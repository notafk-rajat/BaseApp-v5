const express=require("express"),router=express.Router(),User=require("../models/user"),passport=require("passport");router.get("/register",(e,r)=>{r.render("auth/signup")}),router.post("/register",async(e,r)=>{try{const s={firstName:e.body.firstname,lastName:e.body.lastname,email:e.body.email,username:e.body.username};await User.register(s,e.body.password);e.flash("success","Registered Successfully,Please Login to continue"),r.redirect("/login")}catch(s){e.flash("error",s.message),r.redirect("/register")}}),router.get("/login",(e,r)=>{r.render("auth/login")}),router.post("/login",passport.authenticate("local",{failureRedirect:"/login",failureFlash:!0}),async(e,r)=>{r.redirect("/")}),router.get("/logout",(e,r)=>{e.logout(()=>{r.redirect("/login")})}),module.exports=router;
